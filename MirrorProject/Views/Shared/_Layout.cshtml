<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width" />
        <link rel="stylesheet" type="text/css" href="../../Content/font/weather-icons.css">
        <link rel="stylesheet" type="text/css" href="../../Content/font/weather-icons-wind.css">
        
        <script src="../../Scripts/time.js" type="text/javascript"></script>
        <title>@ViewBag.Title</title>
        @Styles.Render("~/Content/css")
        @Scripts.Render("~/bundles/modernizr")
        @Scripts.Render("~/bundles/jquery")
    </head>
    <body>
        <div>
            @RenderBody()
        </div>
        <script type="text/javascript">
            setInterval(function () {
                $.ajax({
                    url: 'Home/WeatherUpdate',
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: successFunc,
                    error: errorFunc
                });
            }, 1000 * 60);

            function successFunc(data, status) {
                var weatherReport = JSON.parse(data);
                $(".temp-now").html(weatherReport.Temp + "&deg;");
                $(".winddir-now").html(weatherReport.WindDir);
                $("#temp-now-icon").attr("class","wi "+weatherReport.ForecastIcon + " xdimmed")
                $(".windspeed-now").html(weatherReport.WindSpeed + "km/h");
                $(".temp-high").html(weatherReport.ForecastTempHigh + "&deg;");
                $(".temp-low").html(weatherReport.ForecastTempLow + "&deg;");
                $(".forecast-now").html(weatherReport.ForecastTxtToday);
            }

            function errorFunc() {
                
            }
        </script>
        
        @Scripts.Render("~/bundles/bootstrap")
        @RenderSection("scripts", required: false)
    </body>
</html>
